version: "2"
plugins:
- name: mygen
  wasm:
    url: file://sql/plugins/sqlc-gen-go.wasm
    sha256: "7a51c338bd280a833fd59f84ce71479c858ae60290efa8d98a32801a8c464d68"
overrides:
  go:
    overrides:
      - db_type: "INT_UNIX_SEC"
        engine: "sqlite"
        go_type:
          type: "UnixTime"
      - db_type: "INT_BOOL"
        engine: "sqlite"
        nullable: false
        go_type:
          type: "bool"
sql:
  - engine: "sqlite"
    queries:
      - "sql/query_bilibili.sql"
      - "sql/query_chat.sql"
      - "sql/query_coc.sql"
      - "sql/query_pics.sql"
      - "sql/query_gemini.sql"
      - "sql/query_user.sql"
      - "sql/query_ytdl.sql"
      - "sql/query_gemini.sql"
    schema:
      - "sql/schema_bilibili.sql"
      - "sql/schema_chat.sql"
      - "sql/schema_coc.sql"
      - "sql/schema_pics.sql"
      - "sql/schema_gemini.sql"
      - "sql/schema_user.sql"
      - "sql/schema_ytdl.sql"
      - "sql/schema_gemini.sql"
    codegen:
    - out: globalcfg/q
      plugin: mygen
      options:
        package: "q"
        out: "globalcfg/q"
        output_files_suffix: "_gen"
        output_db_file_name: "db_gen.go"
        output_models_file_name: "models_gen.go"
        output_batch_file_name: "batch_gen.go"
        output_querier_file_name: "querier_gen.go"
        emit_json_tags: true
        query_parameter_limit: 4
        emit_prepared_queries: true
        rename:
          chat_cfg: chatCfg
        overrides:
        - db_type: "INT_UNIX_SEC"
          engine: "sqlite"
          go_type:
            type: "UnixTime"
        - db_type: "INT_BOOL"
          engine: "sqlite"
          nullable: false
          go_type:
            type: "bool"
        - db_type: "BLOB_USER_TO_CNT"
          engine: "sqlite"
          go_type:
            type: UserMsgStatMap
        - db_type: "BLOB_TEN_MINUTE_STAT"
          engine: "sqlite"
          go_type:
            type: TenMinuteStats
  # - engine: "sqlite"
  #   queries:
  #     - "sql/query_saved_msg.sql"
  #   schema:
  #     - "sql/schema_saved_msg.sql"
  #   gen:
  #     go:
  #       package: "savedmsg"
  #       out: "globalcfg/savedmsg"
  #       output_files_suffix: "_gen"
  #       output_db_file_name: "db_gen.go"
  #       output_models_file_name: "models_gen.go"
  #       output_batch_file_name: "batch_gen.go"
  #       output_querier_file_name: "querier_gen.go"
  #       emit_json_tags: true
  #       query_parameter_limit: 5
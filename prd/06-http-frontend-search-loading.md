# **Product Requirements Document — HTTP Frontend Search Loading & Infinite Scroll**

## **产品名称：HTTP Web 前端搜索交互增强**

## **版本：v1.0**

## **撰写日期：2025-12-14**

---

## **1. 背景（Background）**

当前 `http/frontend` 的搜索页（`+page.svelte`）已提供基本查询与结果列表，但缺少顺滑的加载体验：请求期间页面看起来卡顿，滚动到底部后不会自动加载下一页，返回数据为空时也没有清晰提示。需要补齐加载动画与“滚动到底自动加载”能力，减少用户手动点击或等待的不确定性。

---

## **2. 目标（Objectives）**

* 在搜索请求进行时提供明显的等待动画与状态提示，避免空白/卡住的感受。
* 支持滚动到底部自动触发下一页加载（无限滚动），与现有分页参数兼容。
* 当已无更多结果或 `hits.length == 0` 时，列表底部展示「没有更多了」提示。
* 保持与现有 SvelteKit 结构、样式体系一致，避免破坏既有功能。

---

## **3. 非目标（Out of Scope）**

* 不调整搜索 API 协议、分页字段或后端接口。
* 不新增搜索过滤条件、排序逻辑或高级筛选。
* 不引入全局状态管理方案（如 store 重构）；仅在当前页面范围内完善交互。

---

## **4. 用户角色（User Personas）**

### **终端搜索用户**
* 需要持续滚动浏览结果，无需手动点击“加载更多”。
* 在网络波动时希望看到明确的加载状态与结尾提示。

### **运营 / QA**
* 需要可复现的加载动画与“没有更多了”展示，便于验收与演示。

### **前端开发者**
* 需要改动局部、可维护，易于与现有代码风格合并，并保持可测试性。

---

## **5. 用户故事（User Stories）**

1. 作为搜索用户，我输入关键词后看到加载动画，知道请求正在进行而不是页面卡住。
2. 作为搜索用户，我向下滚动结果列表到底部时自动加载下一页，不需要点击按钮。
3. 作为搜索用户，当结果列表为空或已加载完所有结果时，我在列表底部看到「没有更多了」提示，避免重复等待。

---

## **6. 功能需求（Functional Requirements）**

### **6.1 交互与体验**

| ID   | 描述                                                                               | 优先级 |
| ---- | -------------------------------------------------------------------------------- | --- |
| FR-1 | 搜索请求进行时在列表/卡片区域展示可见的等待动画或骨架（不遮挡输入框），避免页面静止。            | 高  |
| FR-2 | 当用户滚动到列表底部时自动触发下一页加载，沿用现有分页参数（如 `page`/`limit` 或偏移）。 | 高  |
| FR-3 | 当返回结果 `hits.length == 0` 或没有更多数据时，在列表底部展示提示文案“没有更多了”。          | 高  |
| FR-4 | 正在加载下一页时仍显示加载动画，避免重复触发；加载失败时在底部给出错误/重试提示（可简化为按钮）。 | 中  |

### **6.2 兼容性与样式**

| ID   | 描述                                                                                   | 优先级 |
| ---- | ------------------------------------------------------------------------------------ | --- |
| FR-5 | 维持现有暗色/Telegram 主题变量与组件结构，新增样式通过局部 class/组件封装完成。                  | 中  |
| FR-6 | 等待动画与“没有更多了”提示在移动端（小屏）与桌面端均可见，不遮挡输入框或主要内容。                 | 中  |

### **6.3 可测试性**

| ID   | 描述                                                                                     | 优先级 |
| ---- | -------------------------------------------------------------------------------------- | --- |
| FR-7 | 提供基本测试用例或手动验收说明，覆盖：初次加载动画展示、滚动触发下一页、空结果显示“没有更多了”。 | 中  |

---

## **7. 非功能需求（Non-functional Requirements）**

* **可维护性**：新增逻辑保持在 `+page.svelte` 或相关组件内部，可读、可扩展；避免与其他路由耦合。
* **性能**：无限滚动仅在接近底部时触发，避免频繁请求；加载动画不应显著影响渲染性能。
* **可用性**：加载状态、结束提示的文字与动画清晰易懂，不会与现有交互冲突。

---

## **8. 验收标准（Acceptance Criteria）**

1. 输入关键词触发搜索时，列表区域出现加载动画（或骨架）；请求完成后恢复正常展示。
2. 在结果较多时向下滚动到底部自动请求下一页，成功后附加到现有列表；正在请求中不会重复触发。
3. 当接口返回 `hits.length == 0` 或所有数据加载完毕，列表底部显示“没有更多了”且不再触发新请求。
4. 加载失败时出现提示与重试入口（按钮或轻量提示），恢复后可继续自动加载。
5. 移动端和桌面端均能看到加载动画与“没有更多了”提示，不遮挡搜索框或其他核心交互。
